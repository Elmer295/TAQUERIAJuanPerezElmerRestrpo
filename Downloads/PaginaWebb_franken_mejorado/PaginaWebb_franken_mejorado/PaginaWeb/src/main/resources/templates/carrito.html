<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>ðŸ›’ Carrito de Compras - TaquerÃ­a ElmeroTaco</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

    <!-- Tu CSS -->
    <link href="/css/carrito.css" rel="stylesheet">
</head>

<body class="carrito-bg">
    <th:block th:replace="fragments/navbar :: navbar"></th:block>

<div class="container carrito-container">

    <h1 class="mb-4 titulo-carrito">ðŸ›’ Tu Carrito de Tacos</h1>

    <div class="alert alert-info text-center fade-in" th:if="${mensaje}" th:text="${mensaje}">
        Tienes productos en tu carrito
    </div>

    <div class="table-responsive carrito-card zoom-hover">
        <form action="/menu/carrito/editar" method="post">
            <table class="table table-hover align-middle text-center mb-0">

                <thead class="table-warning table-head-fixed">
                    <tr>
                        <th><i class="bi bi-image"></i></th>
                        <th><i class="bi bi-basket"></i> Taco</th>
                        <th><i class="bi bi-arrows-angle-expand"></i> TamaÃ±o</th>
                        <th><i class="bi bi-123"></i> Cantidad</th>
                        <th><i class="bi bi-cash-coin"></i> Precio</th>
                        <th><i class="bi bi-calculator"></i> Subtotal</th>
                        <th><i class="bi bi-gear"></i></th>
                    </tr>
                </thead>

                <tbody>
                    <tr class="fila-taco fade-in" th:each="item : ${carrito}">

                        <td>
                            <img th:src="@{'/img/' + ${item.opcion.imagen}}" 
                                 th:alt="${item.opcion.nombre}" 
                                 class="item-img">
                        </td>

                        <td th:text="${item.opcion.nombre}">Taco</td>

                        <td th:text="${item.tamano}">Normal</td>

                        <td>
                            <input type="hidden" name="id[]" th:value="${item.id}">
                            <input type="hidden" name="tamano[]" th:value="${item.tamano}">
                            <input type="number" name="cantidad[]" min="1"
                                   th:value="${item.cantidad}"
                                   class="form-control text-center cantidad-input">
                        </td>

                        <td th:text="'$' + ${item.precio}">$0</td>

                        <td th:text="'$' + (${item.precio} * ${item.cantidad})">$0</td>

                        <td class="acciones-btn">
                            <button type="submit" class="btn btn-sm btn-actualizar">
                                <i class="bi bi-arrow-repeat"></i>
                            </button>

                            <a th:href="@{'/menu/carrito/eliminar/' + ${item.id}}"
                               class="btn btn-sm btn-danger ms-1">
                                <i class="bi bi-trash3-fill"></i>
                            </a>
                        </td>

                    </tr>
                </tbody>
            </table>
        </form>
    </div>

    <div class="d-flex justify-content-between align-items-center mt-3">
        <p class="mb-0 total">
            Total: <span th:text="'$' + ${total}">$0</span>
        </p>

        <form action="/menu/confirmarCompra" method="post">
            <button type="submit" class="btn btn-success boton-confirmar">
                <i class="bi bi-check-circle-fill"></i> Confirmar compra
            </button>
        </form>
    </div>

    <div class="text-center mt-4">
        <a href="/menu" class="btn btn-primary">
            <i class="bi bi-arrow-left-circle"></i> Seguir comprando
        </a>

        <a href="/menu/carrito/cancelar" class="btn btn-outline-danger ms-2">
            <i class="bi bi-x-circle"></i> Vaciar carrito
        </a>
    </div>

</div>

<th:block th:replace="fragments/footer :: footer"></th:block>
</body>
</html>
